<Page
    x:Class="Bangumi.Pages.DetailsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Bangumi.Pages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:data="using:Bangumi.Models"
    xmlns:sys="using:System"
    Loaded="Page_Loaded"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <ScrollViewer>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <StackPanel Orientation="Vertical" >
                <StackPanel Orientation="Horizontal" >
                    <Image Name="BangumiImage" 
                       Height="214" 
                       Width="150" />
                    <StackPanel Orientation="Vertical" 
                            Margin="10,0">
                        <TextBlock Name="NameTextBlock" 
                               FontSize="23" 
                               Foreground="#d26585" />
                        <TextBlock Name="air_dateTextBlock" 
                               Text="开播时间：" 
                               FontSize="15" 
                               Foreground="#666666" 
                               Margin="0,2,0,0" />
                        <TextBlock Name="air_weekdayTextBlock" 
                               Text="更新时间：" 
                               FontSize="15" 
                               Foreground="#666666" 
                               Margin="0,2,0,0" />
                        <Button Name="CollectionButton" >
                            <Button.Flyout>
                                <MenuFlyout>
                                    <MenuFlyoutItem Text="想看" 
                                                Click="WishCollectionFlyoutItem_Click" />
                                    <MenuFlyoutItem Text="看过"
                                                Click="WatchedCollectionFlyoutItem_Click"/>
                                    <MenuFlyoutItem Text="在看"
                                                Click="DoingCollectionFlyoutItem_Click"/>
                                    <MenuFlyoutItem Text="搁置"
                                                Click="OnHoldCollectionFlyoutItem_Click"/>
                                    <MenuFlyoutItem Text="抛弃"
                                                Click="DropCollectionFlyoutItem_Click"/>
                                    <MenuFlyoutItem Text="删除"
                                                Visibility="Collapsed"
                                                Click="RemoveCollectionFlyoutItem_Click"/>
                                </MenuFlyout>
                            </Button.Flyout>
                            <StackPanel Orientation="Horizontal">
                                <FontIcon Name="CollectionButtonIcon" 
                                      FontFamily="Segoe MDL2 Assets" 
                                      Glyph="&#xE006;" 
                                      Margin="0,0,5,0"/>
                                <TextBlock Name="CollectionButtonText" 
                                       Text="收藏" />
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </StackPanel>
                <TextBlock Name="SummaryTextBlock" 
                       FontSize="18" 
                       TextWrapping="Wrap" 
                       LineHeight="30" 
                       Margin="0,5,0,0" />

            </StackPanel>
            <ProgressBar Name="MyProgressBar"
                     Grid.Row="1"
                     IsIndeterminate="True"
                     Visibility="Collapsed"
                     VerticalAlignment="Top"/>
            <ProgressRing Name="MyProgressRing"
                      Grid.RowSpan="2"
                      Width="50"
                      Height="50"/>
            <GridView Name="EpsGridView" 
                  Grid.Row="1" 
                  ItemsSource="{x:Bind eps}" >
                <GridView.ItemTemplate>
                    <DataTemplate x:DataType="data:Ep">
                        <StackPanel Tapped="Eps_Tapped" 
                                Orientation="Horizontal" 
                                Margin="5" >
                            <FlyoutBase.AttachedFlyout>
                                <MenuFlyout>
                                    <MenuFlyoutItem Click="WatchedMenuFlyoutItem_Click" 
                                                Text="看过"/>
                                    <MenuFlyoutItem Click="WatchedToMenuFlyoutItem_Click" 
                                                IsEnabled="True" 
                                                Text="看到"/>
                                    <MenuFlyoutItem Click="QueueMenuFlyoutItem_Click" 
                                                Text="想看"/>
                                    <MenuFlyoutItem Click="DropMenuFlyoutItem_Click" 
                                                Text="抛弃"/>
                                    <MenuFlyoutItem Click="RemoveMenuFlyoutItem_Click" 
                                                Text="未看"/>
                                </MenuFlyout>
                            </FlyoutBase.AttachedFlyout>
                            <StackPanel Orientation="Vertical" 
                                    Width="160" 
                                    Margin="6,0">
                                <TextBlock Text="{x:Bind sys:String.Format('第 {0} 话', sort)}" 
                                       FontSize="14" 
                                       TextWrapping="Wrap"/>
                                <TextBlock Text="{x:Bind name_cn}" 
                                       FontSize="14" 
                                       TextWrapping="Wrap"/>
                                <TextBlock Text="{x:Bind status,Mode=OneWay}" 
                                       FontSize="12" 
                                       TextWrapping="Wrap"/>
                            </StackPanel>
                        </StackPanel>

                    </DataTemplate>
                </GridView.ItemTemplate>
            </GridView>


        </Grid>
    </ScrollViewer>
</Page>
